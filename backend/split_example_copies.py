"""
example_copy를 개별 레코드로 분리하는 스크립트
- 기존 A, B, C... 레코드는 부모로 유지 (example_copy 비움)
- 각 예시별로 자식 레코드 생성
"""
import argparse
from conn import get_supabase_client

# 유형별 예시 원고 (분리됨)
SPLIT_EXAMPLES = {
    "A": [
        {
            "variant_name": "일반 판매 금지/의료기기 재분류",
            "example_copy": """닐라브 질염청결제는 금일부로 '일반 판매 금지'가 결정되었습니다.

그동안 닐라브에 보내주신 관심과 사랑에 깊은 감사를 표하며, 다음과 같은 이유로 일반 소비자 대상 판매가 중지되었음을 알립니다.

단순 세정 효과를 넘어 질 점막에 유산균 보호막을 직접 이식하여 질염 원인균을 99% 박멸하고 재발을 막는 효과가 단순 청결 목적의 일반인이 사용하기에는 성분이 지나치게 강력하고 전문적이라는 판단하에 '치료 목적의 의료기기'로 재분류 처분을 받게 되었습니다.

저희도 단종 결정에 불복하고 행정 소송까지 갔습니다. 정말 힘든 싸움이었는데 대법원까지 가서야 겨우 다시 팔 수 있게 됐습니다.

근데 조건이 붙었어요. 단종 대신 핵심 성분 함량을 10분의 1로 줄이라는 거였죠.

문제는 함량만 줄어드는 게 아니라는 겁니다. 효과도 솔직히 10분의 1로 줄어들 수밖에 없어요. 이제 2주 만에 눈에 보이던 드라마틱한 효과는 없어지는 거예요.

다행인 건 지금 여러분이 사시는 이 제품이 바로 단종 직전에 생산된 고함량 원버전이라는 겁니다. 소송 때문에 묶여있던 마지막 물량이죠.

하지만 이것도 이제 다음 주 뒤부터는 못 구하게 돼요. 그 뒤로는 저희도 팔고 싶어도 못 팝니다. 법적으로 함량이 조정된 버전만 만들고 팔아야 하거든요.

관심 있으셨던 분들 지금 빨리 쟁여야 해요..."""
        },
        {
            "variant_name": "개발자 대법원 재판/함량 조정",
            "example_copy": """안녕하세요, 개발자입니다. 오늘 꼭 드릴 말씀이 있어서요.

저희 제품 진짜 판매 금지될 뻔한 거 아세요?

효과가 너무 빨라서 안전성 문제 때문에 단종된다는 소문 들었을 거예요. 네, 그 소문 사실 맞습니다.

저희도 처음엔 몰랐는데, 개발 과정에서 핵심 성분이 일반 기준치의 10배 넘게 들어갔더라고요.

결과는 엄청났죠. 2주 만에 드라마틱한 효과가 나왔던 거예요.

하지만 그 강력한 효과가 결국 문제가 됐습니다. 안전성이 의심된다는 이유로 저희는 단종 처분을 받았어요.

행정 소송 끝에 대법원에서 다시 팔 수 있게 됐지만, 조건이 붙었습니다. 핵심 성분 함량을 10분의 1로 줄이라는 거였죠.

이제 2주 만에 보이던 드라마틱한 효과는 없어지는 거예요.

지금 사시는 이 제품이 바로 단종 직전의 고함량 원버전입니다. 3일 뒤부터는 못 구해요.

이 폭발적인 효과를 경험할 마지막 기회 놓치지 마세요."""
        },
    ],
    "B": [
        {
            "variant_name": "업계 반발/전량 회수 폐기",
            "example_copy": """3일 후 전량 회수 후 폐기 조치 예정입니다.

그동안 저희 제품을 믿고 구매해 주신 모든 분들께 진심으로 감사드립니다.

하지만 유감스럽게도 효과가 너무 탁월하다 보니 고가의 전문 치료를 받던 환자 수가 급격히 줄었고, 결국 관련 이익 단체와 업계의 강한 반발을 불러왔습니다.

그 결과 내려온 행정 조치에 따라 기존 고함량 제품은 전량 회수 후 폐기될 예정이며, 3일 뒤부터는 판매 자체가 전면 금지됩니다.

저희는 마지막으로 이 제품을 꼭 필요로 하셨던 분들께 작은 보답의 의미로 마진 없는 원가 판매 링크를 남깁니다.

이 기회 이후에는 더 이상 국내에서 정품을 만나보실 수 없으며, 가격이 3배 이상 비싼 해외 직구를 통해서만 구매하실 수 있습니다."""
        },
    ],
    "C": [
        {
            "variant_name": "고함량 성별 구매 제한",
            "example_copy": """여자가 바르면 효과가 3배 이상 나타난다는 남성용 고함량 제품, 결국 다음 주부터 성별 인증받고 판다.

이게 원래 완전히 손상된 부위까지 영양분을 강제로 밀어넣어 주는 원리다.

근데 남성용 제품은 완전 괴사 환자 전용으로 나온 거라 특허 성분이 여성용보다 훨씬 고함량으로 들어있음.

근데 여자들은 남자들처럼 완전히 망가진 게 아니라 부분적으로만 문제가 있는 거라 반응 속도가 평균 3배는 빠르다.

그래서 여자가 고함량인 남성용을 쓰면 효과가 과하게 빨리 나타나 버리게 되는 거다.

다시 말해 남자가 이걸 쓰면 부분적으로만 개선되겠지만, 여자가 이걸 쓰면 전체적으로 폭발적인 효과가 나타나면서 남자가 썼을 때보다 훨씬 드라마틱한 결과가 나오는 거다."""
        },
        {
            "variant_name": "미용 목적 금지/과도한 효과 주의",
            "example_copy": """다시 한번 말씀드리지만 고작 가벼운 미용 목적으로는 권장해 드리지 않습니다.

괜히 호기심으로 사용했다가 효과가 너무 과하게 나타나서 오히려 부자연스러워 보일 수 있어요.

이게 요즘 별명까지 있을 정도로 전문 시술 5회와 동일한 효과를 가져온 제품인데, 3주 만에 드라마틱한 변화가 나타났어요.

원리는 문제 부위에 직접 침투해서 근본적으로 재생하는 원리래요.

다시 말씀드리지만 고작 단순한 관리 용도로는 권장 드리지 않습니다. 효과가 너무 강해서 오히려 당황하실 수 있어요."""
        },
        {
            "variant_name": "10년 이상 심각한 경우만",
            "example_copy": """10년 이상 심각한 분 아니면 이거 절대 쓰지 마세요.

미리 경고할게요. 욕심내서 하루에 세 번씩 쓰지 마세요. 정상 수준으로 되돌아가서 오히려 적응이 안 된다는 분들 너무 많습니다.

걱정되신다면 제발 정량만 지키세요.

딱 2주만 쓰면 아무리 심각했던 것도 말도 안 되게 깨끗해져요. 그 정도로 효과가 엄청납니다.

이게 요즘 별명까지 있을 정도로 50년 관리한 효과를 그대로 가져온 특허 성분인데, 제 친구도 한 달도 안 써서 완전 정상 수준이라고 진단받았어요.

다시 한번 말씀드리지만 고작 가벼운 걱정 정도이신 분들은 쓰지 마세요."""
        },
    ],
    "D": [
        {
            "variant_name": "의사 면허 반납/온라인 판매 승인",
            "example_copy": """이 정도 문제로는 전문 클리닉 절대 오지 마세요.

다들 큰 시술까지는 하기 싫으시잖아요. 사실 집에서 이것만 쓰면 병원 오실 일이 전혀 없어요.

오늘부터 이거 쓰시기만 하면 2주 뒤에 완전히 달라져 있어요. 다른 건 다 필요 없어요.

만약 이걸로 안 되면 제가 면허 반납할게요.

제가 실제 저희 환자분들 그냥 집에서 이걸로 좋아져서 다들 시술 예약까지 다 취소하더라고요.

이게 실제 임상 데이터로 결론부터 얘기하면 딱 한 번만 사용해도 4주에 드라마틱한 효과가 나요.

이게 전문 시술 5회에 고급 치료 5회 맞는 효과를 구현하는 거예요. 정말 효과가 미친 거죠.

저는 물론이고 제 가족에게도 저는 이거 무조건 추천하는데, 이게 원래 처방을 받아야지만 살 수 있었던 게 이번에 온라인 판매 승인 허가 나면서 쉽게 살 수 있게 됐어요."""
        },
        {
            "variant_name": "전문가 13년차 권유",
            "example_copy": """이런 증상이 보이면 이미 심각한 상황이 코앞으로 다가왔다는 신호입니다.

노화로 인해 문제가 쌓여 발생하는 이 증상은 자연 치유가 절대 안 돼요.

한 번 시작되면 점점 걷잡을 수 없어져서 결국 더 큰 문제를 유발할 수도 있다는 사실.

이때 필요한 게 바로 근본적인 디톡스예요.

특허 성분이 수십 년간 쌓인 문제를 싹 녹여주는 원리거든요. 쓰는 순간 문제가 싹 사라집니다.

진짜 지금 제가 이쪽 연구만 13년 차고요, 큰 시술 고민하는 분들한테 가장 먼저 권하는 게 이거예요. 그 정도로 확실합니다.

그냥 일주일만 써봐도 다 알아요. 시술 얘기 나오기 전에 이걸로 먼저 해보세요."""
        },
        {
            "variant_name": "서울의학TV 출처",
            "example_copy": """출처: 서울의학TV

저는 솔직히 주변 분들에게 기존 방법 쓰지 말라고 해요.

왜냐하면 이게 기존 방법이 문제가 아니에요. 순서가 완전히 잘못됐어요.

이게 실제 데이터를 보면요, 문제가 막 덕지덕지 쌓여있어요.

제가 실제 데이터로 보면 3개월 사용했을 때 82%가 해결돼요.

전 그래서 직접 여러 개 사서 주변에 많이 선물로 주거든요?

2주만 지나도 불편함이 싹 없어졌대요 다들. 한 명도 효과를 못 본 사람이 없어요 정말."""
        },
    ],
    "E": [
        {
            "variant_name": "전재산 보장",
            "example_copy": """이거 쓰고도 그대로면 제가 전재산 드리겠습니다.

한 번만 써도 효과가 나타나니까 써본 사람들 사이에서는 답일 수밖에 없습니다.

첫 번째 이유는 효과입니다.

문제 부위 99.9% 개선하니까 가격이 저렴할 때 구매해 보세요.

쓰면 진짜 달라집니다."""
        },
        {
            "variant_name": "임상 데이터/환불 보장",
            "example_copy": """10년 이상 방치하신 분 중 증상이 있다면 심각한 문제 확정입니다.

임상 데이터로 보면 증상이 있는 경우 3년 이내 큰 문제가 생길 확률이 무려 80%라고 합니다.

증상의 주원인은 오랜 방치로 인한 찌꺼기이며, 이건 아무리 노력해도 절대 자연적으로 해결되지 않고 딱딱하게 굳어 더 큰 문제를 유발합니다.

그래서 전문가들은 이 제품을 사용합니다.

세계 최초 특허 성분이 초고함량 들어있어, 단 일주일 만에 97% 해결합니다.

실제 임상 데이터에서도 2주 사용한 실험자가 검진에서 정상 진단을 받을 정도로 효과는 의심할 필요 없습니다.

효과 없으면 100% 환불까지 해준다고 하니 10년 이상 방치하셨다면 지금 바로 예방하세요!"""
        },
    ],
    "F": [
        {
            "variant_name": "40대 여성 전용",
            "example_copy": """증상이 나타나기 시작했다면 '이것'만 기억하세요!

아직 40대인데.. 멀리서 보면 훨씬 늙어 보인다고요?

이 증상은 노안의 1순위 원인이라는 사실. 하지만 당신은 이제부터 평생 젊어 보일 수 있습니다.

40대 여성의 이 증상은 단순한 것과는 다릅니다.

진짜 원인은 갑작스러운 노화로 인한 급격한 감소 때문이라는 점.

이 원인을 정확히 알아낸 국내 연구진이 해결책으로 개발한 40대 여성 전용 제품입니다.

한 번에 든 50억 마리 역노화 성분과 특허 성분이 이미 사라진 것까지 다시 복구하는데 이거 하나면 끝이에요.

완전 심각했던 것도 단 2주 만에 드라마틱하게 개선됩니다.

이 영상 보고 구매하시는 오직 20명에게만 연말 특가 3+2, 34% 할인 혜택으로 제공.

여러 개 구매하셔서 새해에는 자신감 되찾으세요!"""
        },
        {
            "variant_name": "40대 남성의 여성용 오용",
            "example_copy": """40대 남성 대부분이 모르는 여성용 제품의 비밀!

아직 43세인데 이 문제 때문에 또래보다 20년 늙어 보이던 제가 이거 쓰고 단 일주일 만에 회춘했어요.

바로 '중년 여성 전용' 제품입니다.

남성의 이 문제는 단순 노화지만, 여성은 노화와 갱년기 영향을 동시에 받는 '호르몬성'이라는 점.

따라서 재생 성분 함량이 남성보다 10배 이상으로 설계해야만 효과를 볼 수 있어요.

그런 고함량 제품을 남성이 사용하면 효과가 10배 빠르게 나타나요!"""
        },
        {
            "variant_name": "증상 공감 후기",
            "example_copy": """이 문제 있는데 다른 문제인 줄 아는 사람 특.

1. 움직임에 따라 뭔가 둥둥 떠다님.
2. 흐린 날엔 아예 불편함.
3. 영양제 챙겨먹어도 똑같음.

나 이 증상 생긴 지 몇 년 됐음. 처음엔 그냥 대수롭지 않게 여겼음.

근데 나중엔 계속 불편하니까 너무 스트레스 받더라.

병원도 소용없고 시술도 무섭고 부작용이 심하대서 걍 방치함.

근데 전문가 친구가 이거 추천해 줌.

개선 성분으로 특허까지 땄다길래 하루에 한 번이니까 속는 셈 치고 써봄.

와 2주 됐는데 개운해지더니 한 달 지나니까 걍 싹 사라짐.

심지어 나는 정가에 샀는데 지금은 34% 할인 중임.

이 증상 있는 사람은 꼭 써봐. 완전 인생템임."""
        },
    ],
    "G": [
        {
            "variant_name": "임상 결과/후기 1000건",
            "example_copy": """이 문제를 이렇게 해결한다고?

원인을 알면 가능합니다.

원인은 핵심 성분 분비 저하입니다.

이를 위해 개발된 이 제품은 특허 성분으로 근본 환경을 개선하도록 설계됐습니다.

개선 비율이 최대 164%까지 향상되었고, 꾸준히 사용 시 근본적으로 다시 좋아집니다.

출시하자마자 후기만 1,000건 달렸습니다!

지금 이 링크에서 34% 할인으로 근본부터 달라지는 변화를 시작해 보세요."""
        },
    ],
}

# 부모 유형 ID 매핑
PARENT_IDS = {
    "A": "8b2394bc-2d9b-43cb-aabb-5acfab8e4b15",
    "B": "a0d64e71-2e20-41a3-a450-a15cf9b02fff",
    "C": "cad8087e-3ed1-47bb-b4e0-28174f3fd8cd",
    "D": "42f87da4-062f-476f-a2d6-74e3c3be4ca8",
    "E": "dbef2959-e78f-434f-96ba-49facadd960e",
    "F": "9e3ce1cd-1fc1-4b1b-8802-1765de238aa1",
    "G": "19acfe1a-3709-4f26-ba0e-593e99841c52",
}


def split_example_copies():
    client = get_supabase_client()

    # 1. 부모 레코드의 example_copy 비우기
    print("=== 부모 레코드 example_copy 비우기 ===")
    for code, parent_id in PARENT_IDS.items():
        client.table("copy_types").update({
            "example_copy": None
        }).eq("id", parent_id).execute()
        print(f"  Type {code}: example_copy cleared")

    # 2. 자식 레코드 생성
    print("\n=== 자식 레코드 생성 ===")
    for code, examples in SPLIT_EXAMPLES.items():
        parent_id = PARENT_IDS[code]

        # 부모 정보 가져오기
        parent = client.table("copy_types").select("*").eq("id", parent_id).execute()
        parent_data = parent.data[0]

        for i, example in enumerate(examples, 1):
            child_code = f"{code}-{i}"
            child_data = {
                "code": child_code,
                "name": parent_data["name"],
                "description": parent_data["description"],
                "core_concept": parent_data["core_concept"],
                "prompt_template": parent_data["prompt_template"],
                "parent_id": parent_id,
                "variant_name": example["variant_name"],
                "example_copy": example["example_copy"],
            }

            response = client.table("copy_types").insert(child_data).execute()
            print(f"  Created: {child_code} - {example['variant_name']}")

    print("\n완료! 모든 예시가 개별 레코드로 분리되었습니다.")


def main():
    parser = argparse.ArgumentParser(description="Split example copies into separate records")
    args = parser.parse_args()

    split_example_copies()


if __name__ == "__main__":
    main()
